<div >
  <div style="width: 100%;height: 100%; height: auto !important;height: 100%;
  background-color: #F5F6FA;min-height: 100%;">

    <div class="container shadow-lg rounded-2"
         style="padding-right: 0px;padding-left: 0px;height: 560px;position: relative;" >
      <div style="background-color: #F5F6FA;margin-right: 0px;width: 100%;height: 8%;padding-bottom: 1px">
      <!--<span class="float-start ms-20" style="margin-top: 11px; margin-bottom: 0px;margin-left: 8px;">
        <svg id="Calque_1_copie" data-name="Calque 1 copie" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35.766" height="26.228" viewBox="0 0 35.766 26.228">
          <image id="Calque_1_copie-2" data-name="Calque 1 copie" width="35.766" height="26.228" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAhCAYAAABN2CLhAAAABHNCSVQICAgIfAhkiAAAAuRJREFUWEftmL9rFEEcxW/H+Fs0NoKFBgVNVLCOhaB1QG3yHyjcVtpIFFGDhaIgpJGDxEawSp3GxgQrk0ZLwUqQQBA0UaPmh7u+z+4MGZcQDm52uYMbeLn5zs6877vJ7rvZb5SmaS1rsTmmv4eFfcL2fLD2S0iEvYIRfnrxNvX/CKvCHoGYucSRxQ7Ls2xj5nENnr/CboE58KxZHvLAsyL02LyL+nxXaySM1aJMdGxuqn9PQHC7trcSNizhn6O0Hl1U8LpdlRZ0vVI8hOhRde53iOh16TyBaG6NJx0i+qt09iP6pDpzwoEOEP5Q9/Qd9yCek+BHwln7tPL0Ogfgu1iLycb8mH5xzI9ZF4Lnu3heCqMSvZaLdi02h2wSJxr7YQIxjXgr0cxlDkJZ40RvxbPZFyvyLEsstpm1/0VvyG/rXld0Vf+e7k5Xu9OxGVDC20KfffqLTzuHIRqHHOciOITvLGXO4UA1KQeZyN2jHh3V57RwvKqdaiHPNQl/jujrIhlrgajKpZ+U7EynHZg43/chekidqSq3q4Vc6LyCaB66p8KNFsiqWPpBSS7pnv644dOxOa/BfsG94nB2wC1wCd8ZcAxi91pU9hz0cGCakuCl3D38A1MV+xUgR1d0gE1siqK7001tU4BJvntcEB+vW7gDb724A0Ub3KHoEP5biXu9Yo7vLMSOBwfYjMedZeDwzztFnm+6/kbuMZ+7Rz2iwvNMuBpgE8qkWBD5ZQmfRfSwgskyswXkfi+uQUQ/UOduQOKyqbIDU11ZGmVnCsTPL+MAoikbzAinAhGXSXNL9/RjV6w5okwjwmmBShNlV0Djyd8l7BR+C5RbKdlSpqX/Q+As0mvnU5bFXfYLuA9rKP/C4UrIxPCzDi7msw4HOWh5qHNwnXVfhBcSPM615n5cYoMl9VDdyQhj4+xwXWO5bcUmr0U3EgQR82VJuqqx1K5hjMa6RGPwsi7xuNkcGjzkIW9Wl3btH4JKGDScgzuqAAAAAElFTkSuQmCC"/>
        </svg>

      </span>-->
        <h3 class="text-center" style="margin-top: 11px;"><span style="font-size: 20px;">
          <span style="color: #ff6d00">Thème: </span>Pour définir un niveau d’habilitation électrique selon la norme
          <b class="colorPrimary">NM 06.1.225 (NF C-18-510)</b></span>
        </h3>
      </div>
      <!-- Commencer -->
      <div *ngIf="currentIndex == 'Dx' " class="container" style="width: 100%;height:100%;background-color: white;">
        <div class="row w-75 m-auto">
          <h1 class="text-center mt-5">Ce test de positionnement a pour objectif de (re)définir au mieux un niveau d’habilitation. Le questionnaire est basé sur le référentiel de formation à la prévention des risques d’origine électrique, en accord avec la norme marocaine
            <b style="color: orangered;">NM 06.1.225 (NF C-18-510)</b></h1>
          <h1>Durant ce test, vous avez la possibilité de définir votre niveau d’habilitation:</h1>
          <div class="row w-25 ps-3 m-auto">
            <ul class="ms-5 m-auto">
              <li class="h4">Par tâches</li>
              <li class="h4">Par métier</li>
            </ul>
          </div>
          <h1 class="text-center mt-1">
            A la fin du  test, le niveau d’habilitation est automatiquement enregistré par le système. L’utilisateur a toujours la possibilité de recommencer le test de positionnement.
          </h1>
        </div>
        <h2 class="text-center">B1V, BR, BS, BC, B2 , BE mesurage, BE essai, BE manœuvre, B0 exécutant, B0 chargé de chantier, BP, BF/HF, etc...
        </h2>
        <div class="row w-25 mx-auto d-block" style="margin-top: 50px;">
          <button mat-raised-button color="primary" (click)="currentIndex= 'DTache'">Commencer</button>
        </div>

      </div>

      <!-- tache or metier -->
      <div *ngIf="currentIndex == 'DTache'" class="container" style="width: 100%;height:100%;background-color: white;">
        <div class="row">
          <!--
          <p class="question text-center">Déterminez votre qualification quelques soit le domaine de tension</p>
          <hr style="width: 70%;margin-top: 4px;" class="m-auto"/>
          -->
          <p class="text-center mt-5" style="font-size: 20px; color: #FF6801; margin-top: 20px;">Répondez en cliquant sur la case
            correspondante</p>
        </div>
        <div class="row mt-5 justify-content-between">
          <h3 class="text-center fw-bold " style="margin-bottom: 60px;">Souhaitez-vous déterminer votre
            niveau d’habilitation en fonction des tâches que vous effectuées ou en
            fonction de votre métier?
          </h3>
          <div class="col-6">
            <button (click)="setMode(true)"
              mat-raised-button class="mx-auto d-block buttonHauteTension btnHover"  >
              <b>TÂCHES</b></button>
            <img (click)="setMode(true)" style="cursor: pointer;"
                 class="mt-2 mx-auto d-block" src="assets/images/tache.png" height="212px" width="200px">
          </div>
          <div class="col-6 ">
            <button (click)="setMode(false)"
              class="buttonHauteTension mx-auto d-block btnHover"  mat-raised-button >
              <b>MÉTIERS</b></button>
            <img (click)="setMode(false)" style="cursor: pointer;"
                 class="img mx-auto d-block" src="assets/images/metier.jpeg" height="100px" width="100px">
          </div>
        </div>
      </div>

        <!-- electrique and no electrique screen -->
        <div *ngIf="(currentIndex == 'DElec' ||currentIndex == 'DNelec') && ! onModeMetier" class="container" style="width: 100%;height:100%;background-color: white;">
          <div class="row">
            <!--
            <p class="question text-center">Déterminez votre qualification quelques soit le domaine de tension</p>
            <hr style="width: 70%;margin-top: 4px;" class="m-auto"/>
            -->
            <p class="text-center mt-5 " style="font-size: 20px; color: #FF6801; margin-top: 20px;">Répondez en cliquant sur la case correspondante à vos tâches</p>
          </div>
          <div class="row mt-3 justify-content-between">
            <p class="text-center mb-5 fw-bold">Vous effectuez des tâches de nature...</p>

            <div class="col-6 ">
              <button class="buttonHauteTension mx-auto d-block btnHover" (click)="setElectrique(previousIsTach ? 'D10' : 'D5')"
                      mat-raised-button >
                 <b>ÉLECTRIQUES</b></button>
              <img  (click)="setElectrique(previousIsTach ? 'D10' : 'D5')" style="cursor: pointer;"
                    class="img mx-auto d-block" src="assets/images/elec.jpeg">
            </div>
            <div class="col-6">
              <button  mat-raised-button (click)="setElectrique( previousIsTach ? 'D4' : 'D26')"
                       class="mx-auto d-block buttonHauteTension btnHover"  >
                <b>NON ÉLECTRIQUES</b></button>
              <img (click)="setElectrique( previousIsTach ? 'D4' : 'D26')"  style="cursor: pointer;"
                   class="img mx-auto d-block" src="assets/images/nonElec.jpeg">
            </div>
          </div>
          <div class="row w-25 mt-1 m-auto" >
            <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">Recommencer</button>
          </div>
        </div>

        <!-- oui non -->
        <div *ngIf="onModeTache && startOUINON && data.get(currentIndex).buttons[0].button.includes('Oui')"
             class="container" style="width: 100%;height:100%;background-color: white;">
          <div class="row">
            <p class="question text-center">{{data.get(currentIndex).question}}</p>
            <hr style="width: 70%;margin-top: 4px;" class="m-auto"/>
            <!--
            <p style="font-size: 20px; color: #FF6801; margin-top: 20px;">Répondez en cliquant sur la case correspondante à vos tâches</p>
            -->
          </div>
          <div class="row mt-3 mb-5 justify-content-between">
            <h2 class="text-center mb-5">{{data.get(currentIndex).consigne}}</h2>
            <div class="col-6">
              <button  (click)="setNextIndex(data.get(currentIndex).buttons[0].nextIndex)"
                       mat-raised-button class="mx-auto d-block buttonHauteTension btnHover"  >
                <b>OUI</b></button>
            </div>
            <div class="col-6 ">
              <button  (click)="setNextIndex(data.get(currentIndex).buttons[1].nextIndex)"
                       class="buttonHauteTension mx-auto d-block btnHover"  mat-raised-button >
                <b>NON</b></button>
            </div>
          </div>

          <div class="row w-25 mt-5 m-auto" >
            <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">Recommencer</button>
          </div>
        </div>

        <!-- haute tension base tension -->
        <div *ngIf="onModeTache
      && startOUINON && !data.get(currentIndex).buttons[0].button.includes('Oui') && !data.get(currentIndex).buttons[0].button.includes('HTA')" class="container" style="width: 100%;height:100%;background-color: white;">
          <div class="row">
            <p class="text-center" id="question">{{data.get(currentIndex).question}}</p>
            <hr style="width: 70%;margin-top: 4px;" class="m-auto"/>
            <p class="text-center" style="font-size: 20px; color: #FF6801; margin-top: 20px;">Répondez en cliquant sur la case correspondante à vos tâches</p>
          </div>
          <div class="row mt-3 justify-content-between">
            <p class="text-center mb-5">{{data.get(currentIndex).consigne}}</p>
            <div class="col-6">
              <button  (click)="setNextIndex(data.get(currentIndex).buttons[0].nextIndex)"
                       mat-raised-button class="mx-auto d-block buttonHauteTension btnHover"  >
                <b>BASSE TENSION</b></button>
              <img class="img mx-auto d-block" src="assets/images/elec.jpeg">
            </div>
            <div class="col-6 ">
              <button (click)="setNextIndex(data.get(currentIndex).buttons[1].nextIndex)"
                      class="buttonHauteTension mx-auto d-block btnHover"  mat-raised-button >
                <b>HAUTE TENSION</b></button>
              <img class="img mx-auto d-block" src="assets/images/hauteTension.jpeg">
            </div>
          </div>

          <div class="row w-25 mt-2 m-auto">
            <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">Recommencer</button>
          </div>
        </div>

        <!-- hta -->
        <div *ngIf="onModeTache
      && startOUINON && data.get(currentIndex).buttons[0].button.includes('HTA')" class="container" style="width: 100%;height:100%;background-color: white;">
          <div class="row">
            <p class="question text-center">{{data.get(currentIndex).question}}</p>
            <hr style="width: 70%;margin-top: 4px;" class="m-auto"/>
            <p class="text-center" style="font-size: 20px; color: #FF6801; margin-top: 20px;">Répondez en cliquant sur la case correspondante à vos tâches</p>
          </div>
          <div class="row mt-3 justify-content-between">
            <p class="text-center mb-5"> {{data.get(currentIndex).consigne}} </p>
            <div class="col-6">
              <button  (click)="setNextIndex(data.get(currentIndex).buttons[0].nextIndex)"
                       mat-raised-button class="mx-auto d-block buttonHauteTension btnHover"  >
                <b>HTA</b></button>
<!--              <img class="img mx-auto d-block" src="assets/images/tacheElectrique.png">-->
            </div>
            <div class="col-6 ">
              <button (click)="setNextIndex(data.get(currentIndex).buttons[1].nextIndex)"
                      class="buttonHauteTension mx-auto d-block btnHover"  mat-raised-button >
                <b>HTB</b></button>
<!--              <img class="img mx-auto d-block" src="assets/images/tacheElectrique.png">-->
            </div>
          </div>
          <div class="row w-25 mt-3 m-auto">
            <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">Recommencer</button>
          </div>
        </div>

        <!-- level -->
        <div *ngIf="isLevel" class="container" style="width: 100%;height:100%;background-color: white;" >
          <div class="row">
            <h1 class="text-center mt-5">Votre niveau d’habilitation et:
              <b style="color: #FF6801">{{this.currentIndex}}</b></h1>
          </div>
          <div class="row mt-5 " style="width: 90%;">
            <div class="col-10" >
              <div class="row ps-5">
                <div class="col-6 ps-1 pb-0 pt-0 pe-0" style="overflow: scroll;height: 350px !important; border-radius: 20px;">
                  <table class="table table-striped table-hover"
                         style=" border-bottom: 5px solid #92d04f;">
                    <thead>
                    <tr>
                      <th scope="col" class="head" style="background-color: #92d04f;position: sticky; top: 0; z-index: 1;">Les tâches autorisées</th>
                    </tr>
                    </thead>
                    <tbody style="padding-bottom: 2px;">
                    <tr *ngFor="let a of authorizationMap?.get(currentIndex?.toLowerCase().trim()).authorizedTasks">
                      <td class="tableText">{{a}}</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
                <div class="col-6 ps-1 pb-0 pt-0 pe-0" style=" overflow: scroll;height: 350px !important;border-radius: 20px;">
                  <table class="table table-striped table-hover"
                         style="height: 200px;overflow: scroll;border-bottom: 5px solid red;">
                    <thead>
                    <tr>
                      <th scope="col" class="head"  style="background-color: red;position: sticky; top: 0; z-index: 1;">Les tâches non autorisées</th>
                    </tr>
                    </thead>
                    <tbody style="padding-bottom: 2px;">
                    <tr *ngFor="let a of authorizationMap?.get(currentIndex.toLowerCase().trim()).unAuthorizedTasks">
                      <td class="tableText">{{a}}</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            </div>
            <div class="col-2">
              <div class="row w-50 mx-auto d-block">
                <button mat-raised-button color="primary" class="resultButton" (click)="onDownloadRepport()">Télécharger</button>
                <button mat-raised-button color="primary" class="resultButton" (click)="onConfirm()">Enregistrer</button>
                <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">Recommencer</button>
              </div>

            </div>
          </div>
        </div>

        <!-- level 2.0 -->
        <div *ngIf="false" class="container" style="width: 100%;height:100%;background-color: white;" >
          <div class="row">
            <h1 class="text-center mt-5">Votre niveau d’habilitation et
              <b style="color: #FF6801">{{this.currentIndex}}</b></h1>
              <hr>
          </div>
          <div class="row m-auto justify-content-around" style="width: 90%;">
            <div class="col-2 ms-1 card mt-3 shadow colTask " *ngFor="let a of authorization[0].allTasks"
                [style]="authorizationMap.
                get(currentIndex.toLowerCase().trim()).authorizedTasks.includes(a)?
                'background-color: green;':'background-color: red;'"
            >
                <h3 class="text-center text-white fw-bold mt-2" style="text-align: center;">{{a}}</h3>
            </div>
          </div>
          <div class="row mt-2 ms-5">
            <p style="border-left: 20px solid green;padding-left: 10px;">Les taches autorses</p>
            <p style="border-left: 20px solid red;padding-left: 10px;">Les taches non autorses</p>
          </div>
          <div class="row w-50 m-auto">
            <div class="col-4">
              <button mat-raised-button color="primary" class="resultButton" (click)="onDownloadRepport()">
                <mat-icon>file_download</mat-icon>
                Telecharger</button>
            </div>
            <div class="col-4">
              <button mat-raised-button color="primary" class="resultButton" (click)="onConfirm()">
                <mat-icon>save</mat-icon>
                Enregistrer</button>
            </div>
            <div class="col-4">
              <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">
                <mat-icon>restart_alt</mat-icon>
                Re-Commencer</button>
            </div>
          </div>
        </div>

        <!-- no level sensibilisation -->
        <div *ngIf="isNoHabilitation" class="container" style="width: 100%;height:100%;background-color: white;">
          <div class="row m-auto w-75 ">
            <article class="cardHabilitation mt-5 pb-5 ps-5 pt-3 shadow-sm">
              <h1 class="mt-3 fw-bold" style="color:orangered;">Pas d’habilitation requise</h1>
              <p  style="font-size: 21px;color: #57585D;">D’après ce questionnaire vous n’avez pas besoin d'une habilitation
                electrique
                en fonction de la norme <b>NM 06.1.225 (NF C-18-510)</b></p>
            </article>
          </div>
          <div class="row w-25 mt-5 m-auto">
            <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">recommencer</button>
          </div>
        </div>


        <div *ngIf="noLevel" class="container" style="width: 100%;height:100%;background-color: white;">
          <div class="row m-auto w-75 ">
            <article class="cardHabilitation mt-5 pb-5 ps-5 pt-3 shadow-sm">
              <h1 class="mt-3 fw-bold" style="color:orangered;">Pas de niveau d’habilitation</h1>
              <p  style="font-size: 21px;color: #57585D;">D’après ce questionnaire vous n’avez pas pu identifier vos
                tâches permettant de définir un niveau d’habilitation électrique
                en fonction de la norme <b>NM 06.1.225 (NF C-18-510)</b></p>
            </article>
          </div>
          <div class="row w-25 mt-5 m-auto">
            <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">recommencer</button>
          </div>

        </div>



      <!-- metier -->
      <div *ngIf="onModeMetier && currentIndex=='DMetier'" class="container" style="width: 100%;height:100%;background-color: white;position: absolute">

        <div class="container w-50 m-auto">
          <div class="row">
           <div style="margin-top: 70px;">
             <label for="select1" class="colorPrimary fw-bold"><h2>Choisir une catégorie</h2></label>
             <select id="select1" (change)="getNewCat($event)" class="form-select form-select-lg mb-3"  aria-label=".form-select-lg example">
               <option selected disabled>Catégories de métiers...</option>
               <option value="{{c.categoryName}}" *ngFor="let c of metier.categories">{{c.categoryName}}</option>
             </select>
           </div>
          </div>
          <hr class="colorPrimary">
          <div class="row" *ngIf="category != null || category!= undefined">
            <div  style="margin-top: 70px;" >
              <label for="select2" class="colorPrimary"><h2>Choisir un métier</h2></label>
              <select id="select2" (change)="getNewTsk($event)" class="form-select form-select-lg mb-3"aria-label=".form-select-lg example">
                <option selected disabled>Métiers...</option>
                <option value="{{task.taskName}}" *ngFor="let task of category.tasks">{{task.taskName}}</option>
              </select>
            </div>
          </div>
        </div>
        <div style="position: relative; bottom: 0;" class="row w-25 m-auto">
          <button mat-raised-button color="primary" class="resultButton" (click)="onRestart()">Recommencer</button>
        </div>

      </div>


    </div>
  </div>
</div>



